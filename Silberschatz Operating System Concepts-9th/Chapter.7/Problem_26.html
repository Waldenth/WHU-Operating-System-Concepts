<h2>Step-1</h2>
<div class="answer"> <p>Pseudocode using semaphores to prevent deadlock:</p> <p>// semaphore value to cross the bridge</p> <p>Semaphore allowed_to_cross_bridge=1;</p> <p>// function definition</p> <p>Void go_into_bridge()</p> <p>{</p> <p> // suspended the process of crossing the bridge</p> <p> Allowed_to_cross_bridge.wait();</p> <p>}</p> <p>//function definition</p> <p>Void way_out_of_bridge()</p> <p>{</p> <p> // resume the suspended process</p> <p> Allow_to_cross_bridge.signal();</p> <p>}</p> </div>
<h2>Step-2</h2>
<div class="answer"> <p>To the above code add no_waiting_north, no_waiting_south and previous inorder to know which side has crossed most recently. If south side van is crossed recently then north side van is given chance to cross the bridge and south side van will be in waiting state until there is no van on the north side or vice versa.</p> <p>If a car finishes crossing on the south side and no car waiting on the south side then the car on the north side will go or vice-versa.</p> <p>monitor bridge</p> <p>{</p> <p> int no_waiting_north=0;</p> <p> int no_waiting_south=0;</p> <p> int on_bridge=0;</p> <p> ok_to_crossbridge();</p> <p> {}</p> <p> int previous=0;</p> <p> cross_bridge_south()</p> <p>{</p> <p> no_waiting_south++;</p> <p> while( on_bridge || previous==0 && no_waiting_north>0)</p> <p> {</p> <p> </p> <p> allowed_to_cross_bridge.wait();</p> <p> on_bridge=1;</p> <p> no_waiting_south--;</p> <p> previous=0;</p> <p> }</p> <p> leave_bridge_south()</p> <p> {</p> <p> on_bridge=0;</p> <p> allowed_to_cross_bridge.announce();</p> <p> }</p> <p>}</p> <p> cross_bridge_north()</p> <p>{</p> <p> no_waiting_north++;</p> <p> while( on_bridge || previous==0 && no_waiting_south>0)</p> <p> {</p> <p> </p> <p> allowed_to_cross_bridge.wait();</p> <p> on_bridge=1;</p> <p> no_waiting_north--;</p> <p> previous=0;</p> <p> }</p> <p> leave_bridge_north()</p> <p> {</p> <p> on_bridge=0;</p> <p> allowed_to_cross_bridge.announce();</p> <p> }</p> <p> </p> <p>}</p></div>
